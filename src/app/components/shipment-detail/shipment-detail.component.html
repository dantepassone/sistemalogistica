<div class="detail-container" *ngIf="shipment">
  <div class="detail-header">
    <button class="btn-back" (click)="goBack()">← Volver al listado</button>
    <h1>Detalle del Envío</h1>
    <p class="shipment-id">ID: {{ shipment.id }}</p>
  </div>

  <div class="detail-content">
    <div class="detail-section">
      <h2>Información del Envío</h2>
      <div class="info-grid">
        <div class="info-item">
          <label>Código de Trazabilidad:</label>
          <span><strong>{{ shipment.codigoTrazabilidad || 'N/A' }}</strong></span>
        </div>
        <div class="info-item">
          <label>Estado Actual:</label>
          <span class="status-badge" [ngClass]="getStatusClass(shipment.estado)">
            {{ shipment.estado }}
          </span>
        </div>
        <div class="info-item" *ngIf="shipment.ubicacionActual">
          <label>Ubicación Actual:</label>
          <span>{{ shipment.ubicacionActual }}</span>
        </div>
        <div class="info-item">
          <label>Remitente:</label>
          <span>{{ shipment.remitente }}</span>
        </div>
        <div class="info-item">
          <label>Destinatario:</label>
          <span>{{ shipment.destinatario }}</span>
        </div>
        <div class="info-item">
          <label>Origen:</label>
          <span>{{ shipment.origen }}</span>
        </div>
        <div class="info-item">
          <label>Destino:</label>
          <span>{{ shipment.destino }}</span>
        </div>
        <div class="info-item">
          <label>Ciudad:</label>
          <span>{{ shipment.ciudad }}</span>
        </div>
        <div class="info-item">
          <label>Provincia:</label>
          <span>{{ shipment.provincia }}</span>
        </div>
        <div class="info-item">
          <label>Dirección:</label>
          <span>{{ shipment.direccion }}</span>
        </div>
        <div class="info-item">
          <label>Ruta Asignada:</label>
          <span>{{ shipment.rutaAsignada }}</span>
        </div>
        <div class="info-item">
          <label>Fecha Estimada de Entrega:</label>
          <span>{{ shipment.fechaEstimadaEntrega }}</span>
        </div>
        <div class="info-item" *ngIf="shipment.peso">
          <label>Peso:</label>
          <span>{{ shipment.peso }} kg</span>
        </div>
        <div class="info-item" *ngIf="shipment.dimensiones">
          <label>Dimensiones:</label>
          <span>{{ shipment.dimensiones }}</span>
        </div>
        <div class="info-item" *ngIf="shipment.valorDeclarado">
          <label>Valor Declarado:</label>
          <span>${{ shipment.valorDeclarado | number }}</span>
        </div>
        <div class="info-item" *ngIf="shipment.vehiculoAsignado">
          <label>Vehículo Asignado:</label>
          <span>{{ shipment.vehiculoAsignado }}</span>
        </div>
        <div class="info-item" *ngIf="shipment.choferAsignado">
          <label>Chofer Asignado:</label>
          <span>{{ shipment.choferAsignado }}</span>
        </div>
      </div>
    </div>

    <div class="detail-section" *ngIf="shipment.historialTracking && shipment.historialTracking.length > 0">
      <h2>Seguimiento y Trazabilidad</h2>
      <div class="tracking-timeline">
        <div *ngFor="let event of shipment.historialTracking" class="tracking-event">
          <div class="event-marker"></div>
          <div class="event-content">
            <div class="event-header">
              <span class="event-date">{{ event.fecha }} {{ event.hora }}</span>
              <span class="event-status" [ngClass]="getStatusClass(event.estado)">{{ event.estado }}</span>
            </div>
            <p class="event-description">{{ event.descripcion }}</p>
            <p class="event-user" *ngIf="event.usuario">Por: {{ event.usuario }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="actions-section">
      <h2>Acciones</h2>
      <p class="actions-description">Cambiar estado del envío:</p>
      <div class="action-buttons">
        <button 
          *ngFor="let status of availableStatuses"
          class="btn-action"
          [class.disabled]="!canChangeToStatus(status)"
          [disabled]="!canChangeToStatus(status)"
          (click)="changeStatus(status)">
          Cambiar a "{{ status }}"
        </button>
      </div>
      <p class="note">* Solo se pueden cambiar a estados específicos</p>
    </div>
  </div>
</div>

<div class="not-found" *ngIf="!shipment">
  <p>Envío no encontrado</p>
  <button class="btn-back" (click)="goBack()">Volver al listado</button>
</div>

